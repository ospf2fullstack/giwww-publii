<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Defending Against RYUK - Gary Innerarity</title><meta name="description" content="It has been exactly four weeks since Homeland Security, the National Guard and LA DoE scheduled an emergency phone conference with all Technology Directors in the state of Louisiana. During this briefing, we were informed that 6 school districts and 2 government agencies were attacked&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://publii.garyinnerarity.com/defending-against-ryuk/"><link rel="amphtml" href="https://publii.garyinnerarity.com/amp/defending-against-ryuk/"><link rel="alternate" type="application/atom+xml" href="https://publii.garyinnerarity.com/feed.xml"><link rel="alternate" type="application/json" href="https://publii.garyinnerarity.com/feed.json"><meta property="og:title" content="Defending Against RYUK"><meta property="og:image" content="https://publii.garyinnerarity.com/media/website/Site-Logo-2.png"><meta property="og:site_name" content="Gary Innerarity"><meta property="og:description" content="It has been exactly four weeks since Homeland Security, the National Guard and LA DoE scheduled an emergency phone conference with all Technology Directors in the state of Louisiana. During this briefing, we were informed that 6 school districts and 2 government agencies were attacked&hellip;"><meta property="og:url" content="https://publii.garyinnerarity.com/defending-against-ryuk/"><meta property="og:type" content="article"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@ospf2fullstack"><meta name="twitter:title" content="Defending Against RYUK"><meta name="twitter:description" content="It has been exactly four weeks since Homeland Security, the National Guard and LA DoE scheduled an emergency phone conference with all Technology Directors in the state of Louisiana. During this briefing, we were informed that 6 school districts and 2 government agencies were attacked&hellip;"><meta name="twitter:image" content="https://publii.garyinnerarity.com/media/website/Site-Logo-2.png"><link rel="stylesheet" href="https://publii.garyinnerarity.com/assets/css/style.css?v=08042fa161ed0afdadab65e17096ecea"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://publii.garyinnerarity.com/defending-against-ryuk/"},"headline":"Defending Against RYUK","datePublished":"2019-08-24T17:20","dateModified":"2022-10-13T09:57","image":{"@type":"ImageObject","url":"https://publii.garyinnerarity.com/media/website/Site-Logo-2.png","height":876,"width":1580},"description":"It has been exactly four weeks since Homeland Security, the National Guard and LA DoE scheduled an emergency phone conference with all Technology Directors in the state of Louisiana. During this briefing, we were informed that 6 school districts and 2 government agencies were attacked&hellip;","author":{"@type":"Person","name":"Gary Innerarity","url":"https://publii.garyinnerarity.com/authors/gary-innerarity/"},"publisher":{"@type":"Organization","name":"Gary Innerarity","logo":{"@type":"ImageObject","url":"https://publii.garyinnerarity.com/media/website/Site-Logo-2.png","height":876,"width":1580}}}</script></head><body><header class="topbar" id="js-header"><div class="topbar__inner"><a class="logo" href="https://publii.garyinnerarity.com/"><img src="https://publii.garyinnerarity.com/media/website/Site-Logo-2.png" alt="Gary Innerarity" width="1580" height="876"></a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://publii.garyinnerarity.com/" target="_self">Home</a></li><li><a href="https://publii.garyinnerarity.com/tags/" target="_self">Categories</a></li></ul></nav></div></header><div class="content"><div class="infobar"><div class="infobar__update">Last Updated: <time datetime="2022-10-13T10:06">October 13, 2022</time></div><div class="infobar__search"></div></div><main class="main"><article class="post"><header class="u-header post__header"><h1>Defending Against RYUK</h1><div class="u-header__meta u-small"><div><a href="https://publii.garyinnerarity.com/authors/gary-innerarity/" title="Gary Innerarity">Gary Innerarity</a> <time datetime="2019-08-24T17:20">August 24, 2019</time></div></div></header><div class="post__entry u-inner"><p></p><figure class="wp-block-image size-large"><figure class="wp-image-711"><img loading="lazy" src="https://publii.garyinnerarity.com/media/posts/45/dims.jpg" sizes="(max-width: 48em) 100vw, 768px" srcset="https://publii.garyinnerarity.com/media/posts/45/responsive/dims-xs.jpg 300w, https://publii.garyinnerarity.com/media/posts/45/responsive/dims-sm.jpg 480w, https://publii.garyinnerarity.com/media/posts/45/responsive/dims-md.jpg 768w, https://publii.garyinnerarity.com/media/posts/45/responsive/dims-lg.jpg 1024w, https://publii.garyinnerarity.com/media/posts/45/responsive/dims-xl.jpg 1360w, https://publii.garyinnerarity.com/media/posts/45/responsive/dims-2xl.jpg 1600w" alt=""></figure><figcaption>Computer code on a screen with a skull representing a computer virus / malware attack.</figcaption></figure><p></p><p></p><p>It has been exactly four weeks since Homeland Security, the National Guard and LA DoE scheduled an emergency phone conference with all Technology Directors in the state of Louisiana.</p><p></p><p></p><p>During this briefing, we were informed that 6 school districts and 2 government agencies were attacked by a ransomware known as <a href="https://www.crowdstrike.com/blog/big-game-hunting-with-ryuk-another-lucrative-targeted-ransomware/">RYUK</a>. The immediate reaction was frightening as the governor of Louisiana demanded a state of emergency. We were told to shut down internet access and remove local admin rights until further notice.</p><p></p><p></p><p>Keep in mind, we were two weeks out from the start of school (smart timing on RYUK). We had to finish deployments for hundreds of chrome books, projector installations, finalize surveillance installs and manage several other projects in our department.</p><p></p><p></p><p>A day passed before we received a strategic game plan from Homeland Security that detailed several phases of security implementations. Phase 1, turn off all internet access. This can be hard to do when your trying to deploy devices, run updates and have 150 staff members coming back to campus...</p><p></p><p></p><p>I'll explain the technologies and how everything works later in the blog.</p><p></p><p></p><p>We spent a week tightening up the ship, blocking internet access based on firewall rules, attempting to have offsite backups work, deploying devices, installing software... we were extremely reliant on the internet.</p><p></p><p></p><p>Services were breaking constantly, as expected when you turn off the internet (LOL, if I don't laugh, I'm crying). My boss could see the stress on our department and offered full support to us while we navigated these high seas. I have to say, I have one of the most supportive bosses in the world (Shout out)!</p><p></p><p></p><p>She granted the additional resources necessary to tackle this oncoming storm.</p><p></p><p></p><p>Four weeks later, 600+ hours between two employees, we now have all systems patched, removed local admin, wiped and deployed. In addition, all members of our organization have been trained on identifying phishing attacks (<a href="https://phishingquiz.withgoogle.com/">for your reference</a>). And the entire network is locked down according to recommendations made by Homeland Security.</p><p></p><p></p><hr class="wp-block-separator"><p></p><p></p><p style="text-align:center;"><strong>The Technical</strong></p><p></p><p></p><hr class="wp-block-separator"><p></p><p></p><p><strong>Known threats to block</strong></p><p></p><p></p><pre class="wp-block-code"><code>deny any any 84.146.54.187/32<restore-line-break>deny any any 75.147.173.236/32<restore-line-break>deny any any 218.16.120.253/32<restore-line-break>deny any any 170.238.117.187/32<restore-line-break>deny any any 195.123.237.129/32<restore-line-break>deny any any 194.5.250.123/32<restore-line-break>deny any any 85.204.116.158/32<restore-line-break>deny any any 31.184.254.18/32<restore-line-break>deny any any 186.10.243.70/32<restore-line-break>deny any any 104.20.209.21/32<restore-line-break>deny any any 445<restore-line-break>deny any any 447<restore-line-break>deny any any 449<restore-line-break>deny any any 8082<restore-line-break>deny any any 16993</restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></restore-line-break></code></pre><p></p><p></p><p>They have identified RDP (3389) and Email (80/443) as the two primary vectors of initiation.</p><p></p><p></p><hr class="wp-block-separator"><p></p><p></p><p><strong>How we "turned off" the internet</strong></p><p></p><p></p><p>Using the firewall "deny any any" and manually adding 40+ pages of "trusted" ip addresses was not an option for us. It was extremely time consuming and impractical. I often fat-fingered IP and port numbers. I broke everything. I wish Meraki allowed me to use a CLI for this type of task. Luckily, Meraki had a second option for us.</p><p></p><p></p><p>Meraki offers Content Filtering, which allows you to blacklist everything (*) and whitelist URL's. I chose this option. Upon blacklisting the entire internet with (*), I was then able to whitelist common sites much more efficiently.</p><p></p><p></p><p>Anything that ends with .gov and .edu were whitelisted, but not completely. Aside from these, every other site had to be whitelisted. Aside from the constant adding, this process is very easy.</p><p></p><p></p><p>All traffic is triple filtered with the leading Cisco, Google, and Meraki products in the globe. With dual content filtering, IPS/IDS and AMP screening, our traffic has been relatively clean - to say the least.</p><p></p><p></p><p>When it comes to Meraki, we were also able to filter traffic by country. This allowed us to block traffic from random countries that we have no business communicating with/through.</p><p></p><p></p><p><strong>Anti-virus</strong></p><p></p><p></p><p>We commissioned a new AI based product to help protect all of our servers, faculty and staff. Hoping that their spread of knowledge with the recent attacks will help prevent attacks on our network.</p><p></p><p></p><p><strong>Advanced email filtering &amp; quarantines</strong></p><p></p><p></p><p>Google allows for us to enable advanced email filtering and quarantine. I've enabled all features to flag suspicious emails and I've personally trained every employee on proper email usage and what to look for in an email.</p><p></p><p></p><hr class="wp-block-separator"><p></p><p></p><p>As of today, we are not in the clear, but we are in a much better state now than we were a month ago. We were given the chance to reflect on our current policies, enforce new procedures and tighten up security campus wide. Other organizations were not given the same opportunity as us.</p><p></p><p></p><p>For anyone out there battling this, please reach out if you need support. This is a beast to navigate and cyber crimes are not going away anytime soon.</p><p></p><p></p><hr class="wp-block-separator"><p></p><p></p><p style="text-align:center;">References</p><p></p><p></p><p><a href="https://www.cisecurity.org/">Center for Internet Security (Homeland Security)</a></p><p></p><p></p><p>Read about <a href="https://www.us-cert.gov/ncas/tips/ST19-001">Protecting your network</a></p><p></p><p></p><p>Read about <a href="https://www.us-cert.gov/ncas/alerts/TA18-201A">Emotet Malware</a></p><p></p><p></p><p>Read about <a href="https://www.cisecurity.org/white-papers/security-primer-trickbot/">TrickBot</a></p><p></p></div><aside class="post__aside"><div class="post__last-updated u-small">This article was updated on October 13, 2022</div><div class="post__share"><a href="https://twitter.com/share?url=https%3A%2F%2Fpublii.garyinnerarity.com%2Fdefending-against-ryuk%2F&amp;via=%40ospf2fullstack&amp;text=Defending%20Against%20RYUK" class="js-share twitter" title="Share with Twitter" rel="nofollow noopener noreferrer" aria-label="Share with Twitter"><svg class="u-icon"><use xlink:href="https://publii.garyinnerarity.com/assets/svg/svg-map.svg#twitter"/></svg></a></div></aside><footer class="post__footer"><div class="post__bio box"><div><h4 class="h6"><a href="https://publii.garyinnerarity.com/authors/gary-innerarity/" title="Gary Innerarity">Gary Innerarity</a></h4></div></div><nav class="post__nav box"><div class="post__nav__prev"><a href="https://publii.garyinnerarity.com/knowledge-curve/" class="post__nav__link" rel="prev"><div class="u-small">Previous Post<h5>Knowledge Curve</h5></div></a></div><div class="post__nav__next"><a href="https://publii.garyinnerarity.com/personal-finance/" class="post__nav__link" rel="next"><div class="u-small">Next Post<h5>Personal Finance</h5></div></a></div></nav></footer></article></main><div class="sidebar"><section class="box authors"><h3 class="box__title">Authors</h3><ul class="authors__cotainer"><li class="authors__item"><div><a href="https://publii.garyinnerarity.com/authors/gary-innerarity/" class="authors__title">Gary Innerarity</a></div></li></ul></section></div><footer class="footer"><a class="footer__logo" href="https://publii.garyinnerarity.com/"><img src="https://publii.garyinnerarity.com/media/website/Site-Logo-2.png" alt="Gary Innerarity" width="1580" height="876"></a><nav><ul class="footer__nav"></ul></nav><div class="footer__copyright"><p>Proudly created with Publii and published globally with Github and CloudFlare.</p></div></footer></div><script>window.publiiThemeMenuConfig = {    
        mobileMenuMode: 'sidebar',
        animationSpeed: 300,
        submenuWidth: 'auto',
        doubleClickTime: 500,
        mobileMenuExpandableSubmenus: true, 
        relatedContainerForOverlayMenuSelector: '.navbar',
   };</script><script defer="defer" src="https://publii.garyinnerarity.com/assets/js/scripts.min.js?v=ef33954c8f912e6c18ee116825aadc90"></script><script>var images = document.querySelectorAll('img[loading]');

      for (var i = 0; i < images.length; i++) {
         if (images[i].complete) {
               images[i].classList.add('is-loaded');
         } else {
               images[i].addEventListener('load', function () {
                  this.classList.add('is-loaded');
               }, false);
         }
      }</script></body></html>